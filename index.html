<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒŸ Special GAME ğŸŒŸ</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow-x: hidden;
        }
        .mobile-button {
            touch-action: manipulation;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .no-zoom {
            /* è®“åœ¨æ‰‹æ©Ÿä¸Šæ“ä½œæ™‚ä¸æœƒå› ç‚ºé»æ“Šæˆ–æ»‘å‹•è€Œç¸®æ”¾é é¢ */
            touch-action: pan-x pan-y;
        }
        /* é‡å°æ»‘å‹•æ‹¼åœ–çš„éæ¸¡æ•ˆæœ */
        .puzzle-piece {
            transition: transform 0.2s ease-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const BirthdayGameApp = () => {
            const [currentPoints, setCurrentPoints] = useState(0);
            const [currentPage, setCurrentPage] = useState('home');
            const [gameResults, setGameResults] = useState({});
            const [gameState, setGameState] = useState('ready');

            const games = [
                { id: 'guess-number', name: '1A2BçŒœæ•¸å­—', points: 3, difficulty: 'ç°¡å–®', emoji: 'ğŸ”¢' },
                { id: 'memory-card', name: 'ç¿»ç‰Œé€£é€£çœ‹', points: 3, difficulty: 'ä¸­ç­‰', emoji: 'ğŸ´' },
                { id: 'jigsaw-puzzle', name: 'æ»‘å‹•æ‹¼åœ–', points: 8, difficulty: 'å›°é›£', emoji: 'ğŸ§©' },
                { id: 'candy-crush', name: 'ç³–æœæ¶ˆæ¶ˆæ¨‚', points: 2, difficulty: 'ç°¡å–®', emoji: 'ğŸ­' }
            ];
            const completeGame = (gameId, points) => {
                setCurrentPoints(prev => prev + points);
                setGameResults(prev => ({
                    ...prev,
                    [gameId]: (prev[gameId] || 0) + 1
                }));
            };

            // æ»‘å‹•æ‹¼åœ–éŠæˆ² (Sliding Puzzle with Image)
            const JigsawPuzzleGame = () => {
                // é è¨­çš„åœ–ç‰‡ URL - è«‹å‹™å¿…ä¿®æ”¹é€™è£¡ç‚ºæ‚¨åœ¨ GitHub ä¸Šå‚³çš„åœ–ç‰‡é€£çµï¼
                // ç¯„ä¾‹ï¼š'https://Avis0930.github.io/my-surprise-game/my_surprise_image.jpg'
                const defaultImageUrl = 'https://Avis0930.github.io/my-surprise-game/puzzle_jiwoo.jpg'; // <--- **è«‹å‹™å¿…ä¿®æ”¹é€™è£¡ï¼**
                const [currentPuzzleImageUrl, setCurrentPuzzleImageUrl] = useState(defaultImageUrl);
                const [inputImageUrl, setInputImageUrl] = useState(''); // ç”¨æ–¼ä½¿ç”¨è€…è¼¸å…¥çš„ URL

                const [tiles, setTiles] = useState([]);
                const [moves, setMoves] = useState(0);
                const [gameOver, setGameOver] = useState(false);
                const [loadingImage, setLoadingImage] = useState(true);
                const [error, setError] = useState(null);

                const [solvedTileOrder, setSolvedTileOrder] = useState([]);

                useEffect(() => {
                    initializeImagePuzzle(currentPuzzleImageUrl);
                }, [currentPuzzleImageUrl]); // ç•¶åœ–ç‰‡ URL æ”¹è®Šæ™‚é‡æ–°åˆå§‹åŒ–

                // è¼‰å…¥ä¸¦åˆ‡å‰²åœ–ç‰‡
                const initializeImagePuzzle = (url) => {
                    setLoadingImage(true);
                    setError(null);
                    setMoves(0); // é‡ç½®æ­¥æ•¸
                    setGameOver(false); // é‡ç½®éŠæˆ²ç‹€æ…‹

                    const img = new Image();
                    img.crossOrigin = 'Anonymous'; // å˜—è©¦è§£æ±º CORS å•é¡Œ
                    img.src = url;

                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        const pieceSize = 100;
                        const boardSize = 3;

                        canvas.width = pieceSize * boardSize;
                        canvas.height = pieceSize * boardSize;

                        const aspectRatio = img.width / img.height;
                        let drawWidth = canvas.width;
                        let drawHeight = canvas.height;
                        let startX = 0;
                        let startY = 0;

                        if (img.width > img.height) {
                            drawHeight = canvas.width / aspectRatio;
                            startY = (canvas.height - drawHeight) / 2;
                        } else {
                            drawWidth = canvas.height * aspectRatio;
                            startX = (canvas.width - drawWidth) / 2;
                        }

                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        ctx.drawImage(img, startX, startY, drawWidth, drawHeight);

                        const generatedTiles = [];
                        for (let i = 0; i < boardSize * boardSize; i++) {
                            const row = Math.floor(i / boardSize);
                            const col = i % boardSize;
                            const x = col * pieceSize;
                            const y = row * pieceSize;

                            const pieceCanvas = document.createElement('canvas');
                            pieceCanvas.width = pieceSize;
                            pieceCanvas.height = pieceSize;
                            const pieceCtx = pieceCanvas.getContext('2d');
                            pieceCtx.drawImage(canvas, x, y, pieceSize, pieceSize, 0, 0, pieceSize, pieceSize);

                            generatedTiles.push({
                                id: i,
                                dataUrl: pieceCanvas.toDataURL('image/png')
                            });
                        }

                        // å°‡æœ€å¾Œä¸€å¡Šè¨­ç‚ºç©ºç™½
                        generatedTiles[generatedTiles.length - 1].dataUrl = '';

                        setSolvedTileOrder(generatedTiles.map(t => t.id));

                        let shuffledTiles = [...generatedTiles.map(t => ({...t}))];
                        do {
                            const imageTiles = shuffledTiles.slice(0, -1);
                            for (let i = imageTiles.length - 1; i > 0; i--) {
                                const j = Math.floor(Math.random() * (i + 1));
                                [imageTiles[i], imageTiles[j]] = [imageTiles[j], imageTiles[i]];
                            }
                            shuffledTiles = [...imageTiles, shuffledTiles[shuffledTiles.length - 1]];

                        } while (!isSolvable(shuffledTiles.map(t => t.id), boardSize) || isSolved(shuffledTiles.map(t => t.id)));

                        setTiles(shuffledTiles);
                        setMoves(0);
                        setGameOver(false);
                        setLoadingImage(false);
                    };

                    img.onerror = () => {
                        console.error('åœ–ç‰‡è¼‰å…¥å¤±æ•—æˆ–CORSéŒ¯èª¤:', url); // åœ¨æ§åˆ¶å°æ‰“å°éŒ¯èª¤
                        setError('åœ–ç‰‡è¼‰å…¥å¤±æ•—ï¼è«‹æª¢æŸ¥URLæˆ–CORSè¨­å®šã€‚');
                        setLoadingImage(false);
                        // å¯ä»¥è€ƒæ…®é€™è£¡æ¸…ç©ºæ‹¼åœ–æˆ–é¡¯ç¤ºé è¨­éŒ¯èª¤åœ–ç‰‡
                        setTiles([]);
                        setGameOver(true); // è¨­ç½®ç‚ºéŠæˆ²çµæŸç‹€æ…‹ï¼Œç¦æ­¢æ“ä½œ
                    };
                };

                const isSolvable = (currentTileIds, boardSize) => {
                    const flatTiles = currentTileIds.filter(id => id !== solvedTileOrder[solvedTileOrder.length - 1]);
                    let inversions = 0;
                    for (let i = 0; i < flatTiles.length - 1; i++) {
                        for (let j = i + 1; j < flatTiles.length; j++) {
                            if (flatTiles[i] > flatTiles[j]) {
                                inversions++;
                            }
                        }
                    }
                    return inversions % 2 === 0;
                };

                const isSolved = (currentTileIds) => {
                    if (currentTileIds.length === 0) return false; // é¿å…ç©ºé™£åˆ—å°è‡´éŒ¯èª¤åˆ¤æ–·
                    for (let i = 0; i < solvedTileOrder.length; i++) {
                        if (currentTileIds[i] !== solvedTileOrder[i]) {
                            return false;
                        }
                    }
                    return true;
                };

                const handleTileClick = (index) => {
                    if (gameOver || loadingImage || error || tiles.length === 0) return;

                    const blankIndex = tiles.findIndex(t => t.dataUrl === '');

                    const row = Math.floor(index / 3);
                    const col = index % 3;
                    const blankRow = Math.floor(blankIndex / 3);
                    const blankCol = blankIndex % 3;

                    const isAdjacent =
                        (Math.abs(row - blankRow) === 1 && col === blankCol) ||
                        (Math.abs(col - blankCol) === 1 && row === blankRow);

                    if (isAdjacent) {
                        const newTiles = [...tiles];
                        [newTiles[index], newTiles[blankIndex]] = [newTiles[blankIndex], newTiles[index]];
                        setTiles(newTiles);
                        setMoves(moves + 1);

                        const currentTileIds = newTiles.map(t => t.id);
                        if (isSolved(currentTileIds)) {
                            setGameOver(true);
                            setTimeout(() => {
                                completeGame('jigsaw-puzzle', 8);
                                setCurrentPage('success-puzzle');
                            }, 500);
                        }
                    }
                };

                const handleUrlInputChange = (e) => {
                    setInputImageUrl(e.target.value);
                };

                const handleLoadCustomImage = () => {
                    if (inputImageUrl.trim() !== '') {
                        setCurrentPuzzleImageUrl(inputImageUrl.trim());
                    } else {
                        alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„åœ–ç‰‡ URLï¼');
                    }
                };

                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-300 via-indigo-400 to-blue-400 p-4 no-zoom">
                        <div className="max-w-sm mx-auto">
                            <div className="mb-4 bg-white/95 backdrop-blur-sm border-4 border-white shadow-xl rounded-2xl overflow-hidden">
                                <div className="bg-gradient-to-r from-indigo-500 to-blue-600 text-white p-4">
                                    <h2 className="text-center font-black text-xl">ğŸ§© æ»‘å‹•æ‹¼åœ– (åœ–ç‰‡)</h2>
                                    <p className="text-center text-sm text-white/90 font-semibold mt-1">
                                        é»æ“Šç§»å‹•åœ–ç‰‡åˆ°æ­£ç¢ºé †åºï¼âœ¨
                                    </p>
                                    <p className="text-center text-xs text-white/80 mt-1">
                                        æ­¥æ•¸: {moves}
                                    </p>
                                </div>
                                <div className="p-4">
                                    <div className="space-y-4">
                                        {/* URL è¼¸å…¥æ¡† */}
                                        <div className="bg-white rounded-lg p-3 shadow-inner border border-gray-300">
                                            <input
                                                type="text"
                                                placeholder="è¼¸å…¥åœ–ç‰‡ URL (ä¾‹å¦‚: https://example.com/image.jpg)"
                                                value={inputImageUrl}
                                                onChange={handleUrlInputChange}
                                                className="w-full p-2 border border-gray-300 rounded-md text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-300"
                                            />
                                            <button
                                                onClick={handleLoadCustomImage}
                                                className="w-full mt-2 bg-blue-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-blue-600 transition-colors"
                                            >
                                                è¼‰å…¥è‡ªè¨‚åœ–ç‰‡
                                            </button>
                                        </div>

                                        {loadingImage && (
                                            <div className="text-center text-gray-700 font-bold text-lg animate-pulse">
                                                è¼‰å…¥åœ–ç‰‡ä¸­ï¼Œè«‹ç¨å€™...
                                            </div>
                                        )}
                                        {error && (
                                            <div className="text-center text-red-600 font-bold text-lg p-2 bg-red-100 rounded-lg border border-red-300">
                                                éŒ¯èª¤: {error}
                                                <button
                                                    onClick={() => initializeImagePuzzle(defaultImageUrl)}
                                                    className="mt-2 bg-purple-500 text-white px-3 py-1 rounded-full text-sm hover:bg-purple-600"
                                                >
                                                    ä½¿ç”¨é è¨­åœ–ç‰‡
                                                </button>
                                            </div>
                                        )}
                                        {!loadingImage && !error && tiles.length > 0 && (
                                            <>
                                                {/* åƒè€ƒåœ–ç‰‡ */}
                                                <div className="bg-gradient-to-b from-gray-100 to-gray-200 rounded-2xl p-4 border-4 border-gray-300">
                                                    <div className="text-center text-sm font-bold text-gray-700 mb-3">ğŸ¯ åƒè€ƒåœ–ç‰‡</div>
                                                    <div className="flex justify-center">
                                                        <img src={currentPuzzleImageUrl} alt="Reference" className="w-32 h-32 object-cover rounded-lg border-2 border-white shadow-md" />
                                                    </div>
                                                </div>

                                                {/* æ‹¼åœ–å€åŸŸ */}
                                                <div className="grid grid-cols-3 gap-2 p-4 bg-gradient-to-b from-blue-100 to-purple-100 rounded-2xl border-4 border-purple-300">
                                                    {tiles.map((tile, index) => (
                                                        <button
                                                            key={index}
                                                            onClick={() => handleTileClick(index)}
                                                            className={`
                                                                aspect-square rounded-lg flex items-center justify-center text-3xl font-black transition-transform duration-200 ease-out shadow-md overflow-hidden
                                                                ${tile.dataUrl === ''
                                                                    ? 'bg-gray-200 cursor-default'
                                                                    : 'bg-white text-purple-700 hover:scale-105 active:scale-95 cursor-pointer border-2 border-orange-400'
                                                                }
                                                                ${gameOver && tile.dataUrl === '' ? 'hidden' : ''}
                                                            `}
                                                            disabled={gameOver}
                                                        >
                                                            {tile.dataUrl !== '' ? (
                                                                <img src={tile.dataUrl} alt={`puzzle-piece-${tile.id}`} className="w-full h-full object-cover" />
                                                            ) : (
                                                                ''
                                                            )}
                                                        </button>
                                                    ))}
                                                </div>

                                                {gameOver && (
                                                    <div className="text-center text-green-600 font-bold text-lg mt-4 animate-bounce">
                                                        ğŸ‰ æ­å–œå®Œæˆï¼ç²å¾—8é»ï¼
                                                    </div>
                                                )}
                                            </>
                                        )}

                                        <div className="text-center">
                                            <div className="text-sm text-purple-700 font-semibold mb-2">
                                                ğŸ’¡ æ“ä½œèªªæ˜ï¼š
                                            </div>
                                            <div className="text-xs text-purple-600 bg-purple-50 rounded-lg p-2">
                                                é»æ“Šèˆ‡ç©ºç™½æ ¼ç›¸é„°çš„åœ–ç‰‡æ–¹å¡Šä¾†ç§»å‹•å®ƒï¼Œç›´åˆ°åœ–ç‰‡æŒ‰åƒè€ƒåœ–çš„é †åºæ’åˆ—ï¼
                                            </div>
                                            <button
                                                onClick={() => initializeImagePuzzle(currentPuzzleImageUrl)} // é»æ“Šé‡æ–°é–‹å§‹æ™‚ä½¿ç”¨ç•¶å‰åœ–ç‰‡ URL
                                                className="w-full mt-3 bg-gradient-to-r from-blue-400 to-purple-500 text-white px-6 py-3 rounded-full font-black shadow-lg border-2 border-white"
                                            >
                                                é‡æ–°é–‹å§‹ ğŸ”„
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <button
                                    onClick={() => setCurrentPage('home')}
                                    className="w-full bg-gradient-to-r from-gray-400 to-gray-600 text-white py-4 rounded-full font-black shadow-lg border-4 border-white"
                                >
                                    å›åˆ°é¦–é  ğŸ 
                                </button>
                            </div>
                        </div>
                    );
                };

            // ç¬¬ä¸€åŒ…çš„æŠ½å¡æ©Ÿåˆ¶
            const addPoints = () => {
                setCurrentPoints(p => p + 10);
                setGameState('ready');
            };

            const drawCard = () => {
                if (currentPoints < 5 || gameState !== 'ready') return;
                setCurrentPoints(p => p - 5);
                setGameState('drawing');

                setTimeout(() => {
                    setGameState('result');
                }, 2000);
            };

            const resetGame = () => {
                setGameState('ready');
            };

            // é¦–é 
            const HomePage = () => (
                <div className="min-h-screen bg-gradient-to-br from-cyan-300 via-purple-400 to-pink-400 p-4 no-zoom">
                    <div className="max-w-sm mx-auto">
                        <div className="text-center mb-6">
                            <div className="bg-white/90 backdrop-blur-sm rounded-3xl p-6 shadow-2xl border-4 border-white">
                                <h1 className="text-2xl sm:text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-pink-500 mb-2">
                                    Special GAME
                                </h1>
                                <p className="text-purple-700 font-semibold text-sm">å®ŒæˆéŠæˆ²ç²å¾—é»æ•¸ï¼Œé›†æ»¿5é»æŠ½é©šå–œå¡ç‰‡ï¼</p>
                                <div className="flex justify-center space-x-2 mt-3">
                                    <span className="text-2xl">ğŸ’–</span>
                                    <span className="text-2xl">ğŸŒˆ</span>
                                    <span className="text-2xl">âœ¨</span>
                                </div>
                            </div>
                        </div>

                        {/* æ§åˆ¶æŒ‰éˆ• */}
                        <div className="fixed top-4 left-4 space-y-2 z-10">
                            <button onClick={addPoints} className="bg-red-600 text-white px-4 py-2 rounded font-bold">
                                +10é»
                            </button>
                            <button onClick={resetGame} className="bg-gray-600 text-white px-4 py-2 rounded font-bold">
                                é‡ç½®æŠ½å¡
                            </button>
                        </div>

                        {/* é»æ•¸é¡¯ç¤º */}
                        <div className="mb-6 bg-gradient-to-r from-yellow-300 to-orange-300 border-4 border-white shadow-xl rounded-2xl p-6 text-center">
                            <div className="text-2xl font-black text-white mb-2 drop-shadow-lg">
                                â­ é»æ•¸: {currentPoints} â­
                            </div>
                            <div className="text-base font-bold text-purple-800 bg-white/80 rounded-full px-4 py-1">
                                {Math.floor(currentPoints / 5)} æ¬¡æŠ½å¡æ©Ÿæœƒ ğŸ´
                            </div>
                        </div>

                        {/* æŠ½å¡å€åŸŸ */}
                        <div className="bg-gradient-to-r from-yellow-300 via-pink-300 to-purple-300 border-4 border-white rounded-2xl p-6 mb-6">
                            <h3 className="font-black text-xl mb-4 text-white text-center">ğŸ é©šå–œå¡ç‰‡ ğŸ</h3>

                            <div className="text-center">
                                {/* READY ç‹€æ…‹ */}
                                {gameState === 'ready' && (
                                    <div>
                                        {currentPoints >= 5 ? (
                                            <button
                                                onClick={drawCard}
                                                className="w-full bg-cyan-500 text-white px-6 py-4 rounded-full text-lg font-black hover:bg-cyan-600"
                                            >
                                                ğŸ´ æŠ½å¡ç‰‡ï¼(-5é») âœ¨
                                            </button>
                                        ) : (
                                            <div className="bg-white/90 rounded-full px-4 py-3">
                                                <p className="text-purple-700 font-bold">é‚„éœ€è¦ {5 - currentPoints} é»æ‰èƒ½æŠ½å¡ âœ¨</p>
                                            </div>
                                        )}
                                    </div>
                                )}

                                {/* DRAWING ç‹€æ…‹ */}
                                {gameState === 'drawing' && (
                                    <div className="space-y-4">
                                        <div className="text-6xl animate-spin">ğŸ´</div>
                                        <div className="text-white font-bold text-xl animate-pulse">æŠ½å¡ä¸­...</div>
                                    </div>
                                )}

                                {/* RESULT ç‹€æ…‹ */}
                                {gameState === 'result' && (
                                    <div className="space-y-4">
                                        <div className="bg-gradient-to-r from-yellow-400 to-yellow-600 p-6 rounded-3xl border-4 border-white">
                                            <div className="text-4xl mb-3 animate-bounce">ğŸ¥‡</div>
                                            <div className="bg-white/90 rounded-2xl p-4 mb-4">
                                                <div className="text-8xl mb-2">ğŸ’–</div>
                                                <div className="text-xl font-black text-purple-700">PRINCESS</div>
                                            </div>
                                            <div className="text-white text-lg font-bold">è¶…ç´šå¤§ç</div>
                                        </div>

                                        <button
                                            onClick={resetGame}
                                            className="w-full bg-purple-500 text-white px-6 py-3 rounded-full font-bold hover:bg-purple-600"
                                        >
                                            ç¹¼çºŒéŠæˆ² ğŸ’«
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* éŠæˆ²åˆ—è¡¨ */}
                        <div className="space-y-4">
                            {games.map((game, index) => {
                                const gradients = [
                                    'from-pink-400 to-rose-400',
                                    'from-cyan-400 to-blue-400',
                                    'from-purple-400 to-violet-400',
                                    'from-green-400 to-emerald-400'
                                ];
                                return (
                                    <div key={game.id} className={`bg-gradient-to-r ${gradients[index]} border-4 border-white shadow-xl rounded-2xl`}>
                                        <div className="p-4">
                                            <div className="flex justify-between items-center">
                                                <div className="flex-1">
                                                    <h3 className="font-black text-lg text-white drop-shadow-lg">
                                                        {game.emoji} {game.name}
                                                    </h3>
                                                    <p className="text-sm text-white/90 font-semibold">
                                                        {game.difficulty} | {game.points}é» â­
                                                    </p>
                                                    {gameResults[game.id] && (
                                                        <p className="text-sm text-yellow-200 font-bold">
                                                            ğŸ‰ å®Œæˆ {gameResults[game.id]} æ¬¡
                                                        </p>
                                                    )}
                                                </div>
                                                <button
                                                    onClick={() => setCurrentPage(game.id)}
                                                    className="mobile-button bg-white text-purple-700 px-4 py-2 rounded-full font-black hover:bg-yellow-300 transition-all shadow-lg text-sm"
                                                >
                                                    START! ğŸ’«
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
            // çŒœæ•¸å­—éŠæˆ²
            const GuessNumberGame = () => {
                const [targetNumber, setTargetNumber] = useState('');
                const [guess, setGuess] = useState('');
                const [history, setHistory] = useState([]);
                const [attempts, setAttempts] = useState(0);
                const [gameOver, setGameOver] = useState(false);
                useEffect(() => {
                    const digits = [];
                    while (digits.length < 3) {
                        const digit = Math.floor(Math.random() * 10).toString();
                        if (!digits.includes(digit)) {
                            digits.push(digit);
                        }
                    }
                    setTargetNumber(digits.join(''));
                }, []);
                const checkGuess = () => {
                    if (guess.length !== 3 || new Set(guess).size !== 3) {
                        alert('è«‹è¼¸å…¥3ä½ä¸é‡è¤‡æ•¸å­—ï¼');
                        return;
                    }

                    let a = 0, b = 0;
                    for (let i = 0; i < 3; i++) {
                        if (guess[i] === targetNumber[i]) {
                            a++;
                        } else if (targetNumber.includes(guess[i])) {
                            b++;
                        }
                    }

                    const result = `${guess} - ${a}A${b}B`;
                    setHistory([result, ...history]);
                    setAttempts(attempts + 1);

                    if (a === 3) {
                        completeGame('guess-number', 3);
                        setCurrentPage('success-number');
                        return;
                    } else if (attempts + 1 >= 10) {
                        setGameOver(true);
                    }

                    setGuess('');
                };

                const resetNumberGame = () => {
                    setGameOver(false);
                    setHistory([]);
                    setGuess('');
                    setAttempts(0);
                    const digits = [];
                    while (digits.length < 3) {
                        const digit = Math.floor(Math.random() * 10).toString();
                        if (!digits.includes(digit)) {
                            digits.push(digit);
                        }
                    }
                    setTargetNumber(digits.join(''));
                };

                return (
                    <div className="min-h-screen bg-gradient-to-br from-cyan-400 via-purple-500 to-pink-500 p-4 no-zoom">
                        <div className="max-w-sm mx-auto">
                            <div className="mb-4 bg-white/95 backdrop-blur-sm border-4 border-white shadow-xl rounded-2xl overflow-hidden">
                                <div className="bg-gradient-to-r from-blue-400 to-purple-500 text-white p-4">
                                    <h2 className="text-center font-black text-xl">ğŸ”¢ æ•¸å­—éŠæˆ²</h2>
                                    <p className="text-center text-sm text-white/90 font-semibold mt-1">
                                        çŒœå‡º3ä½ä¸é‡è¤‡æ•¸å­—ï¼A=ä½ç½®å’Œæ•¸å­—éƒ½å°ï¼ŒB=æ•¸å­—å°ä½†ä½ç½®éŒ¯ âœ¨
                                    </p>
                                    <p className="text-center text-xs text-white/80 mt-1">
                                        å‰©é¤˜æ©Ÿæœƒ: {10 - attempts} æ¬¡
                                    </p>
                                </div>
                                <div className="p-6">
                                    {!gameOver ? (
                                        <div className="space-y-4">
                                            <div className="space-y-3">
                                                <input
                                                    type="tel"
                                                    value={guess}
                                                    onChange={(e) => setGuess(e.target.value.replace(/\D/g, '').slice(0, 3))}
                                                    placeholder="è¼¸å…¥3ä½æ•¸å­—"
                                                    className="w-full p-4 border-4 border-purple-300 rounded-full text-center text-xl font-bold focus:border-pink-400 focus:outline-none bg-white text-gray-800"
                                                    maxLength={3}
                                                />
                                                <button
                                                    onClick={checkGuess}
                                                    className="w-full bg-gradient-to-r from-cyan-400 to-blue-500 text-white px-6 py-4 rounded-full font-black shadow-lg border-2 border-white"
                                                >
                                                    çŒœæ¸¬! ğŸ’«
                                                </button>
                                            </div>

                                            <div className="max-h-48 overflow-y-auto space-y-2">
                                                {history.map((result, index) => (
                                                    <div key={index} className="p-3 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full text-center font-bold text-purple-700 border-2 border-purple-200">
                                                        {result}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="text-center space-y-4">
                                            <div className="text-4xl animate-pulse">ğŸ˜… éŠæˆ²çµæŸ</div>
                                            <div className="text-lg font-bold text-purple-700 bg-purple-100 rounded-full px-4 py-2">
                                                ç­”æ¡ˆæ˜¯: {targetNumber}
                                            </div>
                                            <div className="text-xl font-black text-red-600 bg-red-100 rounded-full px-6 py-3">âŒ éŠæˆ²å¤±æ•—ï¼æœªç²å¾—é»æ•¸</div>
                                            <button
                                                onClick={resetNumberGame}
                                                className="w-full bg-gradient-to-r from-green-400 to-emerald-500 text-white px-6 py-4 rounded-full font-black shadow-lg border-4 border-white"
                                            >
                                                å†æŒ‘æˆ°ä¸€æ¬¡! ğŸ’ª
                                            </button>
                                        </div>
                                    )}
                                </div>
                            </div>

                            <button
                                onClick={() => setCurrentPage('home')}
                                className="w-full bg-gradient-to-r from-gray-400 to-gray-600 text-white py-4 rounded-full font-black shadow-lg border-4 border-white"
                            >
                                å›åˆ°é¦–é  ğŸ 
                            </button>
                        </div>
                    </div>
                );
            };

            // ç¿»ç‰Œé€£é€£çœ‹éŠæˆ²
            const MemoryCardGame = () => {
                const [cards, setCards] = useState([]);
                const [flippedCards, setFlippedCards] = useState([]);
                const [matchedCards, setMatchedCards] = useState([]);
                const [gameOver, setGameOver] = useState(false);
                const [timeLeft, setTimeLeft] = useState(60);
                const [timerActive, setTimerActive] = useState(false);

                const emojis = ['ğŸ’–', 'ğŸŒˆ', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«', 'ğŸ‰', 'ğŸˆ', 'ğŸ¦„'];
                useEffect(() => {
                    initializeGame();
                }, []);
                useEffect(() => {
                    let interval = null;
                    if (timerActive && timeLeft > 0 && !gameOver) {
                        interval = setInterval(() => {
                            setTimeLeft(timeLeft => {
                                if (timeLeft <= 1) {
                                    setGameOver(true);
                                    setTimerActive(false);
                                    return 0;
                                }
                                return timeLeft - 1;
                            });
                        }, 1000);
                    }
                    return () => clearInterval(interval);
                }, [timerActive, timeLeft, gameOver]);
                const initializeGame = () => {
                    const gameCards = [...emojis, ...emojis].map((emoji, index) => ({
                        id: index,
                        emoji
                    }));

                    for (let i = gameCards.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [gameCards[i], gameCards[j]] = [gameCards[j], gameCards[i]];
                    }

                    setCards(gameCards);
                    setFlippedCards([]);
                    setMatchedCards([]);
                    setGameOver(false);
                    setTimeLeft(60);
                    setTimerActive(true);
                };

                const flipCard = (cardId) => {
                    if (gameOver || flippedCards.length === 2 || flippedCards.includes(cardId) || matchedCards.includes(cardId)) {
                        return;
                    }

                    const newFlipped = [...flippedCards, cardId];
                    setFlippedCards(newFlipped);

                    if (newFlipped.length === 2) {
                        const [first, second] = newFlipped;
                        const firstCard = cards.find(c => c.id === first);
                        const secondCard = cards.find(c => c.id === second);
                        if (firstCard && secondCard && firstCard.emoji === secondCard.emoji) {
                            const newMatched = [...matchedCards, first, second];
                            setMatchedCards(newMatched);

                            if (newMatched.length === cards.length) {
                                completeGame('memory-card', 3);
                                setTimerActive(false);
                                setCurrentPage('success-memory');
                                return;
                            }
                        }

                        setTimeout(() => setFlippedCards([]), 1000);
                    }
                };
                const formatTime = (seconds) => {
                    const mins = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    return `${mins}:${secs.toString().padStart(2, '0')}`;
                };
                return (
                    <div className="min-h-screen bg-gradient-to-br from-pink-400 via-purple-500 to-cyan-400 p-4 no-zoom">
                        <div className="max-w-sm mx-auto">
                            <div className="mb-4 bg-white/95 backdrop-blur-sm border-4 border-white shadow-xl rounded-2xl overflow-hidden">
                                <div className="bg-gradient-to-r from-pink-400 to-purple-500 text-white p-4">
                                    <h2 className="text-center font-black text-xl">ğŸ´ è¨˜æ†¶éŠæˆ²</h2>
                                    <p className="text-center text-sm text-white/90 font-semibold mt-1">
                                        ç¿»é–‹ç›¸åŒçš„å¡ç‰‡é€²è¡Œé…å°ï¼âœ¨
                                    </p>
                                    <div className="text-center mt-2">
                                        <span className={`text-lg font-black ${timeLeft <= 10 ? 'text-red-200 animate-pulse' : 'text-white'}`}>
                                            â° {formatTime(timeLeft)}
                                        </span>
                                    </div>
                                </div>
                                <div className="p-6">
                                    {!gameOver && matchedCards.length < cards.length ? (
                                        <div className="grid grid-cols-4 gap-2">
                                            {cards.map((card) => (
                                                <button
                                                    key={card.id}
                                                    onClick={() => flipCard(card.id)}
                                                    className={`aspect-square text-2xl rounded-xl transition-all duration-300 border-2 border-white shadow-lg ${
                                                        flippedCards.includes(card.id) || matchedCards.includes(card.id)
                                                        ? 'bg-gradient-to-r from-yellow-200 to-pink-200 shadow-xl'
                                                            : 'bg-gradient-to-r from-purple-400 to-pink-400 hover:from-purple-500 hover:to-pink-500'
                                                        } ${matchedCards.includes(card.id) ? 'opacity-60' : ''}`}
                                                >
                                                    {flippedCards.includes(card.id) || matchedCards.includes(card.id) ? card.emoji : 'ğŸ’«'}
                                                </button>
                                            ))}
                                        </div>
                                    ) : (
                                        <div className="text-center space-y-4">
                                            <div className="text-4xl animate-pulse">â° æ™‚é–“åˆ°äº†</div>
                                            <div className="text-lg font-bold text-purple-700 bg-purple-100 rounded-full px-4 py-2">
                                                å·²é…å°: {matchedCards.length / 2} / 8 çµ„
                                            </div>
                                            <div className="text-xl font-black text-red-600 bg-red-100 rounded-full px-6 py-3">âŒ éŠæˆ²å¤±æ•—ï¼æœªç²å¾—é»æ•¸</div>
                                            <button
                                                onClick={initializeGame}
                                                className="w-full bg-gradient-to-r from-green-400 to-emerald-500 text-white px-6 py-4 rounded-full font-black shadow-lg border-4 border-white"
                                            >
                                                å†æŒ‘æˆ°ä¸€æ¬¡! ğŸ’ª
                                            </button>
                                        </div>
                                    )}
                                </div>
                            </div>

                            <button
                                onClick={() => setCurrentPage('home')}
                                className="w-full bg-gradient-to-r from-gray-400 to-gray-600 text-white py-4 rounded-full font-black shadow-lg border-4 border-white"
                            >
                                å›åˆ°é¦–é  ğŸ 
                            </button>
                        </div>
                    </div>
                );
            };

            // æˆåŠŸé é¢çµ„ä»¶
            const SuccessPage = ({ title, emoji, points, gameId }) => (
                <div className="min-h-screen bg-gradient-to-br from-green-300 via-emerald-400 to-teal-500 p-4 flex items-center justify-center no-zoom">
                    <div className="max-w-sm mx-auto text-center">
                        <div className="bg-white/95 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border-4 border-white">
                            <div className="text-6xl mb-4 animate-bounce">{emoji}</div>
                            <h2 className="text-3xl font-black text-green-700 mb-4">{title}</h2>
                            <div className="space-y-3 mb-6">
                                <div className="text-xl font-black text-green-600 bg-yellow-200 rounded-full px-6 py-3 animate-pulse">
                                    âœ… ç²å¾— {points} é»æ•¸ï¼â­
                                </div>
                            </div>
                            <div className="space-y-3">
                                <button
                                    onClick={() => setCurrentPage(gameId)}
                                    className="mobile-button w-full bg-gradient-to-r from-green-400 to-emerald-500 text-white px-6 py-4 rounded-full font-black shadow-lg border-4 border-white text-lg"
                                >
                                    ğŸ® å†ç©ä¸€æ¬¡
                                </button>
                                <button
                                    onClick={() => setCurrentPage('home')}
                                    className="mobile-button w-full bg-gradient-to-r from-purple-400 to-pink-400 text-white px-6 py-4 rounded-full font-black shadow-lg border-4 border-white text-lg"
                                >
                                    ğŸ  å›åˆ°ä¸»ç•«é¢
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // æ ¹æ“šç•¶å‰é é¢æ¸²æŸ“
            const renderPage = () => {
                switch (currentPage) {
                    case 'guess-number':
                        return <GuessNumberGame />;
                    case 'memory-card':
                        return <MemoryCardGame />;
                    case 'jigsaw-puzzle':
                        return <JigsawPuzzleGame />;
                    case 'success-number':
                        return <SuccessPage title="æ­å–œéé—œï¼" emoji="ğŸ‰" points={3} gameId="guess-number" />;
                    case 'success-memory':
                        return <SuccessPage title="è¨˜æ†¶é”äººï¼" emoji="ğŸ‰" points={3} gameId="memory-card" />;
                    case 'success-puzzle':
                        // ä¿®æ­£é»æ•¸ç‚º 8ï¼Œèˆ‡ games åˆ—è¡¨ä¿æŒä¸€è‡´
                        return <SuccessPage title="æ‹¼åœ–å¤§å¸«ï¼" emoji="ğŸ§©" points={8} gameId="jigsaw-puzzle" />;
                    default:
                        return <HomePage />;
                }
            };

            return renderPage();
        };

        ReactDOM.render(<BirthdayGameApp />, document.getElementById('root'));
    </script>
</body>
</html>
